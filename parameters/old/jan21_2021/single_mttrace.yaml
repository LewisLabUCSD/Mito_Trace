## Files that require full paths:
#prefix: "jan21_2021_Croker/MTblacklist"
fastq_dir: "/data2/isshamie/mito_lineage/data/raw/jan21_2021_Croker/" #igm-storage2.ucsd.edu/210114_A00953_0213_AHVM25DSXY"
mtscATAC_OUTDIR: "/data2/isshamie/mito_lineage/data/processed/mtscATAC/jan21_2021/MTblacklist"

samples: "parameters/jan21_2021/jan21_2021.csv"

# mttrace parameters
results: "data/processed/mttrace/jan21_2021/MTblacklist"
#results: "data/processed/mttrace/jan21_2021"
figures: "figures/mttrace/jan21_2021"


# Genome paths
genome_dir: "/data/isshamie/mito_lineage/data/external/GRCh38_MT_blacklist/" #"/data2/mito_lineage/data/external/GRCh38_MT_blacklist/" #
ref_fa: "/data2/mito_lineage/data/external/GRCh38_MT_blacklist/fasta/genome.fa" # I'm pretty sure this and genome_dir are the same and I just moved it.
mt_ref_fa: "/data2/mito_lineage/data/external/GRCh38_MT_blacklist/chrM.fasta"


main:
  - "mtscATAC"
  - "mttrace"
  - "multiplex"


# Predefined inputs, if any
files:
  mttrace:
    coverage:
      P2: "data/processed/mttrace/jan21_2021/MTblacklist/P2/MT/cellr_True/P2_200/P2.coverage.strands.txt.gz"
      J2: "data/processed/mttrace/jan21_2021/MTblacklist/J2/MT/cellr_True/J2_200/J2.coverage.strands.txt.gz"

  filters:
    coverage:
      P2: "data/processed/mttrace/jan21_2021/MTblacklist/P2/MT/cellr_True/P2_200/filters/minC10_minR50_topN0_hetT0.001_hetC10_hetCount5_bq20/P2.coverage.txt"
      J2: "data/processed/mttrace/jan21_2021/MTblacklist/J2/MT/cellr_True/J2_200/filters/minC10_minR50_topN0_hetT0.001_hetC10_hetCount5_bq20/J2.coverage.txt"


mttrace:
  use_cellr_barcode:
    - True

  num_reads_filter:
    - 200

  mito_character: "chrM"
  maxBP: 16571
  base_quality: 20

# For constructing the af_by_cell filter position_filter:
filters:
  #cell_depth: "Gaussian"
  min_cells: 10
  min_reads: 50
  topN: 0
  het_thresh: 0.001
  min_het_cells: 10
  het_count_thresh: 5
  bq_thresh: 20

mgatk:
  # For mgatk to fill in low coverage cell positions
  low_cov_thresh: 10
  chrM_refAllele: "/data2/mito_lineage/data/external/chrM_refAllele.txt"
  ncells_thresh_mgatk: 5

multiplex:
  variants_f: "/data2/mito_lineage/data/external/cellSNP_variants/processed/liftOver_chr_full_genome1K.phase3.SNP_AF5e2.chr1toX.hg38.vcf"
  #genome: "hg38"
  genome_size: "/data/isshamie/mito_lineage/data/external/GRCh38_MT_blacklist/fasta/genome.chrom.size"

  #/data/isshamie/mito_lineage/data/external/GRCh38_MT_blacklistfasta

  use_mt_bam: True
  #sample_csv: "/data2/mito_lineage/parameters/jan21_2021_Croker/jan21_2021_Croker.csv"

  samples:
    - "P2"
    - "J2"

  sample_dict:
    Control: "P2"
    Flt3l: "J2"

  N_DONORS: 4
  pseudo_multiplex:
    #Number Reads Total: 10000000
    num_cells: 100000 # high enough to choose all
    is_proportional: False

  mt:
    minMAF: 0.01
    minCOUNT: 200

  n_clone_list: [20, 40, 100]


annotations:
  datadir: "/data2/mito_lineage/Analysis/annotation/data/granja_cd34"
  name: "granja_published_C1.rds"
