# This version contains filters for reads and cells, done before running mgatk.
# It also add read alignment quality and removes the mapq filtering, as it isn't as informative in bwa.
samples: "parameters/2020_11_18_Croker_mito.csv"
results: "data/processed/mttrace/2020_11_18"
figures: "figures/mttrace/2020_11_18"

main:
  - "mtscATAC"
#workdir: "/data2/mito_lineage/data/processed/200403_A00953_0090_BHC23FDSXY/"

use_cellr_barcode:
  - True

num_reads_filter:
  - 200

mito_character: "chrM"
maxBP: 16571
mapq:
  - 0

base_quality: 20

ref_fa: "/data2/mito_lineage/data/external/GRCh38_MT_blacklist/fasta/genome.fa"
mt_ref_fa: "/data2/mito_lineage/data/external/GRCh38_MT_blacklist/chrM.fasta"


# For constructing the af_by_cell filter
filters:
  # At least n cells with greater than n reads
  min_cells:
    - 100
    - 500
    - 10

  min_reads:
    - 100

  topN:
    - 0

  het_thresh:
    - 0.01

  min_het_cells:
    - 5
    - 10
    - 50

  het_count_thresh:
    - 5
    - 50

  bq_thresh:
    - 30

# For mgatk to fill in low coverage cell positions
low_cov_thresh: 10
